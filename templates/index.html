<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="{{css_url}}" type="text/css" />
    <script src="{{forms_js}}" type="text/javascript">
    </script>
    <title>Repeating Events Scheduler</title>
  </head>
  <body  onload="formsOnload()">
    <h1 class="section">Repeating Events Scheduler</h1>

    <form method="post" action="{{url_for('RepeatingEvents')}}">
      <table>
        {% for field in form if field != form.events %}
        <tr id="{{field.id}}_row"><td class="configinput">{{ field }}</td>
          {% if field.errors %}
          <td>
            <span class="error">
            {{ field.label }}
            <ul>  <!-- TODO: only create ul if len(errors) > 1 -->
            {% for error in field.errors %}<li>{{ error|e }}</i>{% endfor %}
            </ul>
            </span>
          </td>
          {% else %}
          <td>{{ field.label }}</td>
          {% endif %}
        </tr>
        {% endfor %}
      </table>
      <br />
      <table id="events_table">
        <thead><tr><th>Event</th><th>Period (HH:MM)</th></tr></thead>
        <tbody id="events_table_body">
        {% for event in form.events %}
        <tr id="{{event.id}}-row"><td class="eventsummary">{{event.summary}}</td>
          <td>{{event.period}}<input type="button" name="{{event.id}}-delete" id="{{event.id}}-delete" value="Delete Event" onclick="deleteEvent('{{event.id}}')" /></td></tr>
        {% if event.summary.errors or event.period.errors %}
        <tr id="{{event.id}}-errors-row"><td colspan="2">
        <ul class="error">
          {% for error in event.summary.errors %}
          <li>{{ error }}</li>
          {% endfor %}
          {% for error in event.period.errors %}
          <li>{{ error }}</li>
          {% endfor %}
        </ul>
        </td></tr>
        {% endif %}
        {% endfor %}
        </tbody>
      </table>
      <input type="button" value="Add Event" onclick="addEvent()" />
      <input type="submit" value="Create Schedule" />
    </form>
  </body>
</html>
